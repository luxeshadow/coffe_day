import{e as E,B as h,r as i,f as U,c,a as t,y as k,n as C,t as d,G as v,H as g,E as N,F as T,l as _,o as m}from"#entry";const M={class:"p-4"},V={class:"flex gap-2"},B=["onClick"],D=["onClick"],q=E({__name:"users",setup(S){const{$supabase:n}=h(),p=i([]),a=i({name:"",email:""}),l=i(null),f=i("");function o(s,e="success"){l.value=s,f.value=e==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800",setTimeout(()=>l.value=null,3e3)}async function u(){try{const{data:s,error:e}=await n.from("users").select("*");if(e)throw e;p.value=s}catch(s){console.error("Erreur GET:",s.message),o(s.message,"error")}}async function b(){if(!a.value.name||!a.value.email){o("Nom et email sont requis","error");return}try{const{error:s}=await n.from("users").insert([a.value]);if(s)throw s;a.value={name:"",email:""},o("Utilisateur ajouté avec succès"),u()}catch(s){console.error("Erreur INSERT:",s.message),o(s.message,"error")}}async function w(s){const e=prompt("Entrez le nouveau nom:");if(e)try{const{error:r}=await n.from("users").update({name:e}).eq("id",s);if(r)throw r;o("Utilisateur modifié avec succès"),u()}catch(r){console.error("Erreur UPDATE:",r.message),o(r.message,"error")}}async function y(s){if(confirm("Voulez-vous vraiment supprimer cet utilisateur ?"))try{const{error:e}=await n.from("users").delete().eq("id",s);if(e)throw e;o("Utilisateur supprimé avec succès"),u()}catch(e){console.error("Erreur DELETE:",e.message),o(e.message,"error")}}return U(()=>{u()}),(s,e)=>(m(),c("div",M,[e[3]||(e[3]=t("h1",{class:"text-2xl font-bold mb-4"},"Gestion des utilisateurs",-1)),l.value?(m(),c("div",{key:0,class:C([f.value,"mb-4 p-2 rounded"])},d(l.value),3)):k("",!0),t("form",{onSubmit:N(b,["prevent"]),class:"mb-6 flex gap-2"},[v(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>a.value.name=r),placeholder:"Nom",class:"border p-2 rounded"},null,512),[[g,a.value.name]]),v(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>a.value.email=r),placeholder:"Email",class:"border p-2 rounded"},null,512),[[g,a.value.email]]),e[2]||(e[2]=t("button",{type:"submit",class:"bg-blue-500 text-white px-4 rounded"},"Ajouter",-1))],32),e[4]||(e[4]=t("hr",{class:"my-4"},null,-1)),t("ul",null,[(m(!0),c(T,null,_(p.value,r=>(m(),c("li",{key:r.id,class:"flex justify-between items-center mb-2"},[t("span",null,d(r.name)+" - "+d(r.email),1),t("div",V,[t("button",{onClick:x=>w(r.id),class:"bg-yellow-400 px-2 rounded"},"Modifier",8,B),t("button",{onClick:x=>y(r.id),class:"bg-red-500 px-2 text-white rounded"},"Supprimer",8,D)])]))),128))])]))}});export{q as default};
